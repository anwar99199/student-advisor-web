# ๐ ููุฎุต ุงูุฌุฏุงูู ุงููุทููุจุฉ ูู Supabase
## Database Tables Summary

---

## ๐ฏ ุงูุฌุฏุงูู ุงููุทููุจุฉ

### โ ุฌุฏูู ูุงุญุฏ ููุท ูุฌุจ ุฅูุดุงุคู

---

## 1๏ธโฃ ุฌุฏูู `subscriptions` - **ูุฌุจ ุฅูุดุงุคู** โ๏ธ

### ุงูุบุฑุถ:
ุชุฎุฒูู ูุนูููุงุช ุงูุงุดุชุฑุงูุงุช ูุฃููุงุฏ ุงูุชูุนูู ูููุณุชุฎุฏููู

### ุงูุฃุนูุฏุฉ:

| ุงุณู ุงูุนููุฏ | ุงูููุน | ุงููุตู | ููุงุญุธุงุช |
|-----------|-------|-------|---------|
| `id` | UUID | ุงููุนุฑู ุงููุฑูุฏ | Primary Keyุ ูุชู ุชูููุฏู ุชููุงุฆูุงู |
| `activation_code` | TEXT | ููุฏ ุงูุชูุนูู | UNIQUEุ ูุซู: `AC-XYZ123-ABC` |
| `plan` | TEXT | ููุน ุงูุจุงูุฉ | `basic`, `standard`, ุฃู `premium` |
| `status` | TEXT | ุญุงูุฉ ุงูุงุดุชุฑุงู | `active`, `expired`, ุฃู `cancelled` |
| `expires_at` | TIMESTAMPTZ | ุชุงุฑูุฎ ุงูุชูุงุก ุงูุงุดุชุฑุงู | ูุน ุงูุชูููุช |
| `user_email` | TEXT | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ุงุฎุชูุงุฑู (NULL allowed) |
| `created_at` | TIMESTAMPTZ | ุชุงุฑูุฎ ุงูุฅูุดุงุก | ูุชู ุชุนูููู ุชููุงุฆูุงู |
| `updated_at` | TIMESTAMPTZ | ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ | ูุชู ุชุญุฏูุซู ุชููุงุฆูุงู |

### ููููุฉ ุงูุฅูุดุงุก:
```sql
-- ุงูุณุฎ ูุงูุตู ูุฐุง ูู Supabase SQL Editor ุซู ุงุถุบุท Run

CREATE TABLE IF NOT EXISTS subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    activation_code TEXT UNIQUE NOT NULL,
    plan TEXT NOT NULL CHECK (plan IN ('basic', 'standard', 'premium')),
    status TEXT NOT NULL DEFAULT 'active' CHECK (status IN ('active', 'expired', 'cancelled')),
    expires_at TIMESTAMPTZ NOT NULL,
    user_email TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ุฅุถุงูุฉ ุงูููุงุฑุณ ูุชุญุณูู ุงูุฃุฏุงุก
CREATE INDEX idx_subscriptions_activation_code ON subscriptions(activation_code);
CREATE INDEX idx_subscriptions_status ON subscriptions(status);
CREATE INDEX idx_subscriptions_user_email ON subscriptions(user_email);

-- ุชูุนูู Row Level Security
ALTER TABLE subscriptions ENABLE ROW LEVEL SECURITY;

-- ุณูุงุณุฉ ุงููุตูู
CREATE POLICY "Enable all access for service role" ON subscriptions
    FOR ALL USING (true);
```

### ูุซุงู ุนูู ุงูุจูุงูุงุช:
```sql
{
  "id": "123e4567-e89b-12d3-a456-426614174000",
  "activation_code": "AC-XYZ123-ABC",
  "plan": "premium",
  "status": "active",
  "expires_at": "2026-02-17T12:00:00+00:00",
  "user_email": "user@example.com",
  "created_at": "2026-01-17T12:00:00+00:00",
  "updated_at": "2026-01-17T12:00:00+00:00"
}
```

---

## 2๏ธโฃ ุฌุฏูู `kv_store_c2f27df0` - **ููุฌูุฏ ุจุงููุนู** โ

### ุงูุบุฑุถ:
ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุนุงูุฉ ูููุธุงู ุจูุธุงู Key-Value

### ุงูุงุณุชุฎุฏุงู ุงูุญุงูู:
- ุชุฎุฒูู ุงูุฅูุตุงูุงุช ุงููุฑููุนุฉ ูู ุงููุณุชุฎุฏููู
- ุจูุงูุงุช ูุคูุชุฉ ุฃุฎุฑู

### ูุซุงู ุนูู ุงูููุงุชูุญ ุงููุณุชุฎุฏูุฉ:
- `receipt:{uuid}` - ูุนูููุงุช ุฅูุตุงู ูุนูู
- `user:{userId}:receipts` - ูุงุฆูุฉ ุฅูุตุงูุงุช ุงููุณุชุฎุฏู

### โ๏ธ ูุง ุญุงุฌุฉ ูุฃู ุนูู - ุงูุฌุฏูู ููุฌูุฏ ููุนูู

---

## 3๏ธโฃ ุฌุฏูู `auth.users` - **ููุฌูุฏ ุจุงููุนู** โ

### ุงูุบุฑุถ:
ุชุฎุฒูู ุจูุงูุงุช ุงููุณุชุฎุฏููู (ูู Supabase Auth)

### ุงูุฃุนูุฏุฉ ุงูุฑุฆูุณูุฉ:
- `id` - ูุนุฑู ุงููุณุชุฎุฏู
- `email` - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- `encrypted_password` - ูููุฉ ุงููุฑูุฑ ุงููุดูุฑุฉ
- `user_metadata` - ุจูุงูุงุช ุฅุถุงููุฉ (ูุซู ุงูุงุณู)
- `created_at` - ุชุงุฑูุฎ ุงูุชุณุฌูู

### โ๏ธ ูุง ุญุงุฌุฉ ูุฃู ุนูู - ุงูุฌุฏูู ููุฌูุฏ ุชููุงุฆูุงู ูู Supabase

---

## โ ุฌุฏุงูู ุบูุฑ ูุทููุจุฉ

### ุฌุฏูู ุงููุฏูุฑูู (Admins):
**ูุง ุญุงุฌุฉ ูุฅูุดุงุฆู** - ุจูุงูุงุช ุงููุฏูุฑูู ูุฎุฒูุฉ ูู Frontend

### ุฌุฏูู ุงูุฅูุตุงูุงุช (Receipts):
**ูุง ุญุงุฌุฉ ูุฅูุดุงุฆู** - ุงูุฅูุตุงูุงุช ูุฎุฒูุฉ ูู `kv_store_c2f27df0`

### ุฌุฏูู ุงููุณุชุฎุฏููู (Users):
**ูุง ุญุงุฌุฉ ูุฅูุดุงุฆู** - ููุฌูุฏ ุจุงููุนู ูู `auth.users`

---

## ๐ ุฎุทูุงุช ุงูุชูุนูู ุงูุณุฑูุนุฉ

### ุงูุฎุทูุฉ 1: ุงูุชุญ Supabase Dashboard
ุงุฐูุจ ุฅูู: https://supabase.com/dashboard

### ุงูุฎุทูุฉ 2: ุงุฎุชุฑ ูุดุฑูุนู
ุงุฎุชุฑ ุงููุดุฑูุน ุงูุฐู ุชุนูู ุนููู

### ุงูุฎุทูุฉ 3: ุงูุชุญ SQL Editor
ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ โ SQL Editor

### ุงูุฎุทูุฉ 4: ูููุฐ ุงูุณูุฑุจุช
1. ุงูุณุฎ ุงูุณูุฑุจุช ุฃุนูุงู (ูู ุฌุฏูู `subscriptions`)
2. ุงูุตูู ูู ุงููุญุฑุฑ
3. ุงุถุบุท ุฒุฑ **Run** ุฃู **Execute**

### ุงูุฎุทูุฉ 5: ุชุญูู ูู ุงููุฌุงุญ
ุดุบูู ูุฐุง ุงูุงุณุชุนูุงู ููุชุฃูุฏ:
```sql
SELECT * FROM subscriptions LIMIT 5;
```

ุฅุฐุง ูู ุชุธูุฑ ุฃุฎุทุงุกุ ููุฏ ุชู ุงูุฅูุดุงุก ุจูุฌุงุญ! โ

---

## ๐ ุงูุชุญูู ูู ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ

### ููุชุญูู ูู ุฌุฏูู subscriptions:
```sql
SELECT table_name, column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'subscriptions';
```

### ููุชุญูู ูู ุฌุฏูู kv_store:
```sql
SELECT * FROM kv_store_c2f27df0 LIMIT 3;
```

### ููุชุญูู ูู ุงููุณุชุฎุฏููู:
```sql
SELECT id, email, created_at 
FROM auth.users 
LIMIT 5;
```

---

## ๐ ุงูุนูุงูุงุช ุจูู ุงูุฌุฏุงูู

```
auth.users (Supabase Auth)
    โ
    โโโโ (ูุฑูุน ุฅูุตุงูุงุช) โโโ kv_store_c2f27df0
                                 โ
                                 โโโโ (ุจุนุฏ ุงูููุงููุฉ) โโโ subscriptions
                                                              โ
                                                              โโโโ (ูุญุชูู ุนูู activation_code)
```

### ุณูุฑ ุงูุนูู:
1. ุงููุณุชุฎุฏู ูุณุฌู ูู `auth.users`
2. ุงููุณุชุฎุฏู ูุฑูุน ุฅูุตุงู ููุฎุฒู ูู `kv_store_c2f27df0`
3. ุงููุฏูุฑ ููุงูู ุนูู ุงูุฅูุตุงู
4. ูุชู ุฅูุดุงุก ุงุดุชุฑุงู ูู `subscriptions` ูุน ููุฏ ุชูุนูู

---

## โก ูุตุงุฆุญ ุงูุฃุฏุงุก

### ุงูููุงุฑุณ (Indexes) ุงููููุดุฃุฉ:
- โ ุนูู `activation_code` ููุจุญุซ ุงูุณุฑูุน
- โ ุนูู `status` ูููุชุฑุฉ ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ
- โ ุนูู `user_email` ูุฑุจุท ุงููุณุชุฎุฏููู

### ุชุญุณููุงุช ูุณุชูุจููุฉ:
- ุฅุถุงูุฉ Cron Job ูุชุญุฏูุซ ุงูุงุดุชุฑุงูุงุช ุงูููุชููุฉ ุชููุงุฆูุงู
- ุฅูุดุงุก Views ููุชูุงุฑูุฑ ุงูุณุฑูุนุฉ
- ุฅุถุงูุฉ Triggers ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนูุฏ ุงูุชูุงุก ุงูุงุดุชุฑุงู

---

## ๐ก๏ธ ุงูุฃูุงู

### Row Level Security (RLS):
- โ ูููุนูู ุนูู ุฌุฏูู `subscriptions`
- โ ุงูุณูุงุณุฉ ุชุณูุญ ุจุงููุตูู ุงููุงูู ุนุจุฑ `service_role` ููุท
- โ ุงููุณุชุฎุฏููู ุงูุนุงุฏููู ูุง ูููููู ุงููุตูู ูุจุงุดุฑุฉ

### ุงูุญูุงูุฉ:
- ุฌููุน ุงูุนูููุงุช ุชุชู ุนุจุฑ Edge Functions
- ุงุณุชุฎุฏุงู `SUPABASE_SERVICE_ROLE_KEY` ููุนูููุงุช ุงูุญุณุงุณุฉ
- ุนุฏู ุชุณุฑูุจ ุงูููุงุชูุญ ุงูุณุฑูุฉ ุฅูู Frontend

---

## โ Checklist ุงูููุงุฆู

ูุจู ุงูุจุฏุกุ ุชุฃูุฏ ูู:

- [ ] ุชู ุฅูุดุงุก ุฌุฏูู `subscriptions` ุจูุฌุงุญ
- [ ] ุชู ุฅุถุงูุฉ ุฌููุน ุงูููุงุฑุณ (Indexes)
- [ ] ุชู ุชูุนูู RLS ุนูู ุงูุฌุฏูู
- [ ] ุชู ุงุฎุชุจุงุฑ ุงูุฌุฏูู ุจุฅุฏุฎุงู ุจูุงูุงุช ุชุฌุฑูุจูุฉ
- [ ] ุงูู Edge Functions ุชุนูู ุจุดูู ุตุญูุญ
- [ ] ูููู ุงููุตูู ููุฌุฏูู ูู ููุญุฉ ุชุญูู ุงููุฏูุฑ

---

## ๐ ุงููุณุงุนุฏุฉ

ุฅุฐุง ูุงุฌูุช ูุดุงูู:
1. ุชุญูู ูู Console Logs ูู Supabase
2. ุชุฃูุฏ ูู ุตูุงุญูุงุช ุงูู Service Role Key
3. ุฑุงุฌุน ููู `/ADMIN_SETUP_GUIDE.md` ูููุฒูุฏ
4. ุชูุงุตู ุนูู: as8543245@gmail.com

---

**ููุฎุต:**
โ ุฌุฏูู ูุงุญุฏ ููุท ูุฌุจ ุฅูุดุงุคู: `subscriptions`
โ ุจุงูู ุงูุฌุฏุงูู ููุฌูุฏุฉ ุจุงููุนู
โ ุฌููุน ุงูู SQL Scripts ุฌุงูุฒุฉ ููุชูููุฐ

**ููุช ุงูุฅุนุฏุงุฏ ุงููุชููุน:** 5-10 ุฏูุงุฆู โฑ๏ธ
